<div id="main-content" class="slide-left-enter">
  <main class="container pb-1">
    <section id="dashboard" class="section dashboard-section pt-40">

      <div class="text-center mb-20">
        <h2>Gestionar EDUCACION</h2>
      </div>

      <div class="max-w-2xl mx-auto">

        <div id="tarjetas" class="grid grid-cols-1 md:grid-cols-1">
          <!--formulario a√±adir EDUCACION (cursos, talleres)  -->
          <div class="card p-6 mb-8" style="border-color: aqua; border-width: 3px;background-color: rgb(218, 218, 218);">
            <h3 class="text-xl text-center font-semibold mb-6">Crear nueva educaci√≥n</h3>
            <form id="course-form" [formGroup]="educacionForm" (ngSubmit)="guardarEducacion()" class="space-y-6">
              
              <div class="form-group">
                <label class="block mb-2 text-sm font-medium text-gray-700">T√≠tulo *</label>
                <input type="text" formControlName="titulo" class="form-control" placeholder="Nombre del curso o taller">
                <div *ngIf="educacionForm.get('titulo')?.invalid && educacionForm.get('titulo')?.touched" 
                     class="text-red-500 text-sm mt-1">
                  El t√≠tulo es requerido
                </div>
              </div>
              
              <div class="form-group">
                <label class="block mb-2 text-sm font-medium text-gray-700">Descripci√≥n *</label>
                <textarea formControlName="descripcion" class="form-control resize-none" rows="3"
                  placeholder="Breve descripci√≥n del curso..."></textarea>
                <div *ngIf="educacionForm.get('descripcion')?.invalid && educacionForm.get('descripcion')?.touched" 
                     class="text-red-500 text-sm mt-1">
                  La descripci√≥n es requerida (m√≠nimo 10 caracteres)
                </div>
              </div>
              
              <div class="form-group">
                <label class="block mb-2 text-sm font-medium text-gray-700">Tipo de educaci√≥n *</label>
                <select formControlName="tipoEducacion" class="form-control">
                  <option value="">Seleccionar tipo</option>
                  <option value="FORMAL">FORMAL</option>
                  <option value="INFORMAL_CURSO">INFORMAL-CURSO</option>
                  <option value="AUTODIDACTA">AUTODIDACTA</option>
                  <option value="OTROS">OTROS</option>
                </select>
                <div *ngIf="educacionForm.get('tipoEducacion')?.invalid && educacionForm.get('tipoEducacion')?.touched" 
                     class="text-red-500 text-sm mt-1">
                  Debe seleccionar un tipo de educaci√≥n
                </div>
              </div>

              <!-- URL de la imagen -->
              <div class="form-group">
                <label class="block mb-2 text-sm font-medium text-gray-700">URL de la imagen (opcional)</label>
                <input type="text" formControlName="imagenUrl" class="form-control" 
                       placeholder="https://ejemplo.com/certificado.jpg">
              </div>
              
              <!-- Texto alternativo de la imagen -->
              <div class="form-group">
                <label class="block mb-2 text-sm font-medium text-gray-700">Descripci√≥n de la imagen (opcional)</label>
                <input type="text" formControlName="imagenAlt" class="form-control" 
                       placeholder="Certificado de finalizaci√≥n">
              </div>

              <!-- Mensajes de error -->
              <div *ngIf="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                {{ errorMessage }}
              </div>
              
              <div *ngIf="successMessage" class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded">
                {{ successMessage }}
              </div>

              <button type="submit" [disabled]="educacionForm.invalid || guardando" 
                      class="btn-primary w-full py-3 flex items-center justify-center">
                <i class="fas fa-plus-circle mr-2"></i>
                <span *ngIf="!guardando">A√±adir educaci√≥n</span>
                <span *ngIf="guardando">Guardando...</span>
              </button>
            </form>
          </div>
        </div>

      </div>
<div class="text-center mb-20">
        <h2>EDITAR EDUCACION</h2>
      </div>
      <!-- Lista de educaciones existentes para editar -->
      @if (educaciones.length > 0) {
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-8">
          @for (educacion of educaciones; track educacion.id) {
            <div class="card">
              <div class="p-4" style="position: relative; display: inline-block;">
                <img [src]="educacion.imagenes[0]?.url || 'assets/default-image.jpg'" 
                     [alt]="educacion.imagenes[0]?.alt || 'Imagen de educaci√≥n'" 
                     class="campaign-img rounded">
                
                <!-- Contenedor para botones de acci√≥n -->
                <div class="action-buttons">
                  <!-- Bot√≥n Editar -->
                  <button type="button" class="btn btn-primary btn-action btn-editar" 
                          (click)="cargarEducacionParaEditar(educacion)"
                          title="Editar educaci√≥n">
                    ‚úèÔ∏è
                  </button>
                  
                  <!-- Bot√≥n Eliminar -->
                  <button type="button" class="btn btn-danger btn-action btn-eliminar" 
                          (click)="confirmarEliminacion(educacion)"
                          title="Eliminar educaci√≥n">
                    üóëÔ∏è
                  </button>
                </div>
              </div>
              
              <div class="p-5">
                <span class="text-sm text-[color:var(--accent)]">
                  Tipo de educaci√≥n: 
                  <span class="badge text-bg-secondary">{{educacion.tipoEducacion}}</span>
                </span>
                <h3 class="text-xl font-semibold my-2">{{educacion.titulo}}</h3>
                <p class="mb-4 text-[color:var(--text-secondary)]">{{educacion.descripcion}}</p>
              </div>
            </div>
          }
        </div>
      } @else {
        <div class="text-center py-8">
          <p class="text-gray-500">No hay educaci√≥n registrada a√∫n. Agrega la primera.</p>
        </div>
      }

      <!-- MODAL PERSONALIZADO PARA EDITAR EDUCACI√ìN -->
      @if (mostrarModal) {
        <div class="modal-overlay">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">
                Editando Educaci√≥n: {{educacionEditada.titulo}}
              </h5>
              <button type="button" class="btn-close" (click)="cerrarModal()" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            
            <div class="modal-body">
              <div class="bg-white rounded-lg shadow-md p-6">
                <div *ngIf="mensaje" class="mensaje" [class]="mensajeTipo === 'error' ? 'text-red-600' : 'text-green-600'">
                  {{ mensaje }}
                </div>

                <form [formGroup]="editarEducacionForm" (ngSubmit)="actualizarEducacion()">
                  
                  <!-- T√≠tulo -->
                  <div class="form-group mb-4">
                    <label class="block mb-2 text-sm font-medium text-gray-700">T√≠tulo *</label>
                    <input type="text" formControlName="titulo" class="form-control">
                    <div *ngIf="editarEducacionForm.get('titulo')?.invalid && editarEducacionForm.get('titulo')?.touched" 
                         class="text-red-500 text-sm mt-1">
                      El t√≠tulo es requerido (m√≠nimo 3 caracteres)
                    </div>
                  </div>

                  <!-- Descripci√≥n -->
                  <div class="form-group mb-4">
                    <label class="block mb-2 text-sm font-medium text-gray-700">Descripci√≥n *</label>
                    <textarea formControlName="descripcion" class="form-control" rows="4"></textarea>
                    <div *ngIf="editarEducacionForm.get('descripcion')?.invalid && editarEducacionForm.get('descripcion')?.touched" 
                         class="text-red-500 text-sm mt-1">
                      La descripci√≥n es requerida (m√≠nimo 10 caracteres)
                    </div>
                  </div>

                  <!-- Tipo de educaci√≥n -->
                  <div class="form-group mb-4">
                    <label class="block mb-2 text-sm font-medium text-gray-700">Tipo de educaci√≥n *</label>
                    <select formControlName="tipoEducacion" class="form-control">
                      <option value="">Seleccionar tipo</option>
                      <option value="FORMAL">FORMAL</option>
                      <option value="INFORMAL_CURSO">INFORMAL-CURSO</option>
                      <option value="AUTODIDACTA">AUTODIDACTA</option>
                      <option value="OTROS">OTROS</option>
                    </select>
                    <div *ngIf="editarEducacionForm.get('tipoEducacion')?.invalid && editarEducacionForm.get('tipoEducacion')?.touched" 
                         class="text-red-500 text-sm mt-1">
                      Debe seleccionar un tipo de educaci√≥n
                    </div>
                  </div>

                  <!-- URL de la imagen -->
                  <div class="form-group mb-4">
                    <label class="block mb-2 text-sm font-medium text-gray-700">URL de la imagen</label>
                    <input type="text" formControlName="imagenUrl" class="form-control" 
                           placeholder="https://ejemplo.com/certificado.jpg">
                  </div>

                  <!-- Texto alternativo de la imagen -->
                  <div class="form-group mb-6">
                    <label class="block mb-2 text-sm font-medium text-gray-700">Descripci√≥n de la imagen</label>
                    <input type="text" formControlName="imagenAlt" class="form-control" 
                           placeholder="Certificado de finalizaci√≥n">
                  </div>

                  <div class="form-actions flex justify-between">
                    <button type="submit" class="btn btn-primary px-6 py-2" [disabled]="actualizando || editarEducacionForm.invalid">
                      <span *ngIf="!actualizando">
                        <i class="fas fa-paper-plane me-2"></i>Actualizar educaci√≥n
                      </span>
                      <span *ngIf="actualizando">
                        <i class="fas fa-spinner fa-spin me-2"></i>Actualizando...
                      </span>
                    </button>
                    
                    <button type="button" class="btn btn-secondary px-6 py-2" (click)="cerrarModal()">
                      Cancelar
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      }

      <!-- MODAL DE CONFIRMACI√ìN PARA ELIMINAR -->
      @if (mostrarModalConfirmacion) {
        <div class="modal-overlay">
          <div class="modal-content modal-confirmacion">
            <div class="modal-header">
              <h5 class="modal-title">
                <i class="fas fa-exclamation-triangle me-2 text-yellow-500"></i>
                Confirmar eliminaci√≥n
              </h5>
              <button type="button" class="btn-close" (click)="cancelarEliminacion()" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            
            <div class="modal-body">
              <div class="text-center p-6">
                <div class="mb-4">
                  <i class="fas fa-trash-alt text-red-500 text-5xl mb-4"></i>
                  <h3 class="text-xl font-semibold text-gray-800 mb-2">
                    ¬øEst√° seguro de eliminar esta educaci√≥n?
                  </h3>
                  <p class="text-gray-600">
                    Est√° a punto de eliminar: <strong>"{{educacionAEliminar?.titulo}}"</strong>
                  </p>
                  <p class="text-gray-500 text-sm mt-2">
                    Esta acci√≥n no se puede deshacer.
                  </p>
                </div>
                
                <div class="flex justify-center space-x-4 mt-6">
                  <button type="button" class="btn btn-danger px-6 py-2" 
                          (click)="eliminarEducacion()" 
                          [disabled]="eliminando">
                    <span *ngIf="!eliminando">
                      <i class="fas fa-trash me-2"></i>S√≠, eliminar
                    </span>
                    <span *ngIf="eliminando">
                      <i class="fas fa-spinner fa-spin me-2"></i>Eliminando...
                    </span>
                  </button>
                  
                  <button type="button" class="btn btn-secondary px-6 py-2" 
                          (click)="cancelarEliminacion()"
                          [disabled]="eliminando">
                    <i class="fas fa-times me-2"></i>Cancelar
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      }

    </section>
  </main>
</div>